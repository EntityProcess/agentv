# A list of all supported evaluation targets for the project.
# Each target defines a provider and its specific configuration.
# Actual values for paths/keys are stored in the local .env file.

targets:
  - name: default
    provider: azure
    endpoint: ${{ AZURE_OPENAI_ENDPOINT }}
    api_key: ${{ AZURE_OPENAI_API_KEY }}
    model: ${{ AZURE_DEPLOYMENT_NAME }}
    # version: ${{ AZURE_OPENAI_API_VERSION }}  # Optional: uncomment to override default (2024-12-01-preview)

  - name: vscode
    provider: vscode
    judge_target: azure_base

  - name: codex
    provider: codex
    judge_target: azure_base
    # Uses the Codex CLI (defaults to `codex` on PATH)
    # executable: ${{ CODEX_CLI_PATH }}        # Optional: override executable path
    # args:                             # Optional additional CLI arguments
    #   - --profile
    #   - ${{ CODEX_PROFILE }}
    #   - --model
    #   - ${{ CODEX_MODEL }}
    #   - --ask-for-approval
    #   - ${{ CODEX_APPROVAL_PRESET }}
    timeout_seconds: 180
    cwd: ${{ CODEX_WORKSPACE_DIR }}            # Where scratch workspaces are created
    log_dir: ${{ CODEX_LOG_DIR }}              # Optional: where Codex CLI stream logs are stored (defaults to ./.agentv/logs/codex)
    log_format: json                    # Optional: 'summary' (default) or 'json' for raw event logs

  - name: vscode_projectx
    provider: vscode
    workspace_template: ${{ PROJECTX_WORKSPACE_PATH }}
    provider_batching: false
    judge_target: azure_base

  - name: vscode_insiders_projectx
    provider: vscode-insiders
    workspace_template: ${{ PROJECTX_WORKSPACE_PATH }}
    provider_batching: false
    judge_target: azure_base

  - name: azure_base
    provider: azure
    endpoint: ${{ AZURE_OPENAI_ENDPOINT }}
    api_key: ${{ AZURE_OPENAI_API_KEY }}
    model: ${{ AZURE_DEPLOYMENT_NAME }}
    version: ${{ AZURE_OPENAI_API_VERSION }}

  - name: gemini_base
    provider: gemini
    api_key: ${{ GOOGLE_GENERATIVE_AI_API_KEY }}
    model: ${{ GEMINI_MODEL_NAME }}

  - name: local_cli
    provider: cli
    judge_target: azure_base
    # Passes the fully rendered prompt and any attached files to a local Python script
    # NOTE: Do not add quotes around {PROMPT} or {FILES} - they are already shell-escaped
    command_template: uv run ./mock_cli.py --prompt {PROMPT} {FILES} --output {OUTPUT_FILE}
    # Format for each file in {FILES}. {path} and {basename} are automatically shell-escaped, so no quotes needed
    files_format: --file {path}
    # Optional working directory resolved from .env
    cwd: ${{ CLI_EVALS_DIR }}
    timeout_seconds: 30
    healthcheck:
      type: command
      command_template: uv run ./mock_cli.py --healthcheck

  # Mock agent CLI for testing tool_trajectory evaluator
  # Uses a TypeScript CLI that simulates an agent with tool usage
  # Set TOOL_TRAJECTORY_DIR in .env to the absolute path of evals/tool-trajectory/
  - name: mock_agent
    provider: cli
    # No judge_target needed - demos use non-LLM evaluators (tool_trajectory, code_judge)
    command_template: bun run ./mock-agent.ts --prompt {PROMPT} --output {OUTPUT_FILE}
    cwd: ${{ TOOL_TRAJECTORY_DIR }}
    timeout_seconds: 30
    healthcheck:
      type: command
      command_template: bun run ./mock-agent.ts --healthcheck

  # Static trace file target
  # Reads a static JSON trace file and outputs it for evaluation
  # Set TOOL_TRAJECTORY_DIR in .env to the absolute path of evals/tool-trajectory/
  - name: static_trace
    provider: cli
    command_template: bun run ./cat-trace.ts --trace static-trace.json --output {OUTPUT_FILE} --prompt {PROMPT}
    cwd: ${{ TOOL_TRAJECTORY_DIR }}
    timeout_seconds: 10
    healthcheck:
      type: command
      command_template: bun run ./cat-trace.ts --healthcheck
